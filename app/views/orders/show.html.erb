<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">üí≥ –û–ø–ª–∞—Ç–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h4>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <h5>–î–µ—Ç–∞–ª—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h5>
            <table class="table table-sm">
              <tbody>
                <tr>
                  <td><strong>–ù–æ–º–µ—Ä –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:</strong></td>
                  <td>#<%= @order.id %></td>
                </tr>
                <tr>
                  <td><strong>–ü—Ä—ñ–∑–≤–∏—â–µ:</strong></td>
                  <td><%= @order.name %></td>
                </tr>
                <tr>
                  <td><strong>–ê–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong></td>
                  <td><%= @order.address %></td>
                </tr>
                <tr>
                  <td><strong>–°–ø–æ—Å—ñ–± –¥–æ—Å—Ç–∞–≤–∫–∏:</strong></td>
                  <td><%= case @order.shipping_method
                        when 'np' then '–ù–æ–≤–∞ –ü–æ—à—Ç–∞'
                        when 'courier' then "–ö—É—Ä'—î—Ä"
                        when 'pickup' then '–°–∞–º–æ–≤–∏–≤—ñ–∑'
                        else '---'
                        end %>
                  </td>
                </tr>
                <tr>
                  <td><strong>–í–∞—Ä—Ç—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏:</strong></td>
                  <td><%= number_to_currency(@order.shipping_cost.to_f, unit: '‚Ç¥') %></td>
                </tr>
                <tr>
                  <td><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong></td>
                  <td><%= @order.phone %></td>
                </tr>
                <tr>
                  <td><strong>Email:</strong></td>
                  <td><%= @order.email %></td>
                </tr>
              </tbody>
            </table>
          </div>

          <hr>

          <div class="mb-3">
            <h5>–¢–æ–≤–∞—Ä–∏</h5>
            <% @order.order_items.each do |item| %>
              <div class="d-flex justify-content-between mb-2">
                <div>
                  <strong><%= item.book.title %></strong>
                  <br>
                  <small class="text-muted">
                    <%= item.quantity %> √ó <%= number_to_currency(item.unit_price, unit: "‚Ç¥") %>
                  </small>
                </div>
                <div>
                  <strong><%= number_to_currency(item.quantity * item.unit_price, unit: "‚Ç¥") %></strong>
                </div>
              </div>
            <% end %>
          </div>

          <hr>

          <div class="mb-4">
            <h4 class="text-end">
              –°—É–º–∞ –¥–æ –æ–ø–ª–∞—Ç–∏: <span class="text-primary"><%= number_to_currency(@order.total_price, unit: "‚Ç¥") %></span>
            </h4>
          </div>

          <% if @order.payment_status != "completed" %>
            <!-- LiqPay Payment Form -->
            <% if @invoice %>
              <form method="POST" action="<%= @invoice[:action] %>" class="mb-3">
                <input type="hidden" name="data" value="<%= @invoice[:data] %>">
                <input type="hidden" name="signature" value="<%= @invoice[:signature] %>">
                <button type="submit" class="btn btn-success btn-lg w-100">
                  üè¶ –û–ø–ª–∞—Ç–∏—Ç–∏ —á–µ—Ä–µ–∑ LiqPay
                </button>
              </form>
            <% else %>
              <div class="alert alert-info">
                ‚ÑπÔ∏è LiqPay —Å–µ—Ä–≤—ñ—Å –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å LIQPAY_MERCHANT_ID —Ç–∞ LIQPAY_PRIVATE_KEY –≤ .env
              </div>
            <% end %>

            <!-- Cash on delivery -->
            <form method="POST" action="<%= pay_cash_path(@order.id) %>" class="mb-3">
              <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
              <button type="submit" class="btn btn-outline-primary w-100">
                üíµ –û–ø–ª–∞—Ç–∏—Ç–∏ –≥–æ—Ç—ñ–≤–∫–æ—é –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ
              </button>
            </form>

            <div class="alert alert-secondary small">
              <strong>üìù –°–ø–æ—Å–æ–±–∏ –æ–ø–ª–∞—Ç–∏:</strong>
              <ul class="mb-0">
                <li>üè¶ LiqPay - –ø–ª–∞—Ç—ñ–∂ —á–µ—Ä–µ–∑ LiqPay</li>
                <li>üí≥ –ì–æ—Ç—ñ–≤–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ - —Å–ø–ª–∞—Ç–∏—Ç–µ –≤–æ–¥—ñ—î–≤—ñ</li>
              </ul>
            </div>
          <% else %>
            <div class="alert alert-success">
              ‚úÖ <strong>–ü–ª–∞—Ç—ñ–∂ —É—Å–ø—ñ—à–Ω–æ –æ–±—Ä–æ–±–ª–µ–Ω–æ!</strong>
              <br>
              –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å: <span class="badge bg-success"><%= @order.status %></span>
              <br>
              –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂—É: <span class="badge bg-success"><%= @order.payment_status %></span>
            </div>
          <% end %>

          <%= link_to "‚Üê –ù–∞–∑–∞–¥ –¥–æ –∑–∞–º–æ–≤–ª–µ–Ω—å", orders_path, class: "btn btn-secondary mt-3 w-100" %>
        </div>
      </div>
    </div>
  </div>
</div>